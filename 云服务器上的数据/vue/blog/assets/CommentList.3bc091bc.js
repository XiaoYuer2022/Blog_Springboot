import{d as V,r as I,L as z,x as T,W as M,h as t,o as n,c as i,b as e,t as C,z as D,F as L,g as S,N as U,i as W,A as G,y as K,e as B,_ as Q,$ as ae,u as Y,n as Z,p as ee,U as ie,O as ue,D as le,a0 as pe,w as me,j as ce,f as q,a1 as de,a2 as X,X as J,I as re,B as he,C as ge}from"./index.6c00284b.js";import{a as xe,b as _e,l as je,c as H}from"./index.735717a5.js";const ve={class:"view-more-pagination"},Ee={class:"pagination-page-count"},ye=["onClick"],we=V({__name:"Paging",props:{total:{type:Number,default:0},index:{type:Number},commentId:{type:Number}},emits:["getCurrentPage"],setup(g,{expose:b,emit:f}){const u=g,s=I(1),x=I(5),_=I(!1),a=z(()=>Math.ceil(u.total/x.value)),E=z(()=>a.value<=5?a.value:s.value<=4?[1,2,3,4,5,"...",a.value]:s.value>=a.value-4?[1,"...",a.value-5,a.value-4,a.value-3,a.value-2,a.value-1,a.value]:[1,"...",s.value-2,s.value-1,s.value,s.value+1,s.value+2,"...",a.value]),y=()=>{s.value-=1,f("getCurrentPage",s.value,u.index,u.commentId)},j=d=>{s.value=d,f("getCurrentPage",d,u.index,u.commentId)},k=()=>{s.value+=1,f("getCurrentPage",s.value,u.index,u.commentId)};return b({current:s,setPaging:d=>{_.value=d}}),(d,r)=>T((n(),i("div",ve,[e("span",Ee,"\u5171"+C(t(a))+"\u9875",1),t(s)!==1?(n(),i("span",{key:0,class:"pagination-btn",onClick:y},"\u4E0A\u4E00\u9875")):D("",!0),(n(!0),i(L,null,S(t(E),(w,R)=>(n(),i(L,null,[typeof w=="number"?(n(),i("span",{key:R,onClick:N=>j(w),class:U(["pagination-page-number",t(s)==w?"current-page":""])},C(w),11,ye)):(n(),i("span",{class:"pagination-page-do",key:w},"..."))],64))),256)),t(s)!==t(a)?(n(),i("span",{key:1,class:"pagination-btn",onClick:k},"\u4E0B\u4E00\u9875")):D("",!0)],512)),[[M,t(_)]])}});const Ce=W(we,[["__scopeId","data-v-13277137"]]),oe={"[\u70ED]":"https://upload.haoxx.site/emoji/ownEmoji/re.png","[\u51B7]":"https://upload.haoxx.site/emoji/ownEmoji/leng.png","[\u8131\u5355doge]":"https://upload.haoxx.site/emoji/ownEmoji/doge.png","[\u5FAE\u7B11]":"https://upload.haoxx.site/emoji/ownEmoji/simle.png","[\u7B11]":"https://upload.haoxx.site/emoji/ownEmoji/xiao.png","[\u5446]":"https://upload.haoxx.site/emoji/ownEmoji/dai.png","[\u7075\u9B42\u51FA\u7A8D]":"https://upload.haoxx.site/emoji/ownEmoji/lhcq.png","[\u661F\u661F\u773C]":"https://upload.haoxx.site/emoji/ownEmoji/xxy.png","[\u8138\u7EA2]":"https://upload.haoxx.site/emoji/ownEmoji/lianhong.png","[\u5077\u7B11]":"https://upload.haoxx.site/emoji/ownEmoji/touxiao.png","[\u5410]":"https://upload.haoxx.site/emoji/ownEmoji/tu.png","[\u60CA\u559C]":"https://upload.haoxx.site/emoji/ownEmoji/jingxi.png","[\u56E7]":"https://upload.haoxx.site/emoji/ownEmoji/jiong.png","[\u62A0\u9F3B]":"https://upload.haoxx.site/emoji/ownEmoji/koubi.png","[\u54C8\u6B20]":"https://upload.haoxx.site/emoji/ownEmoji/hqian.png","[\u5927\u54ED]":"https://upload.haoxx.site/emoji/ownEmoji/daku.png","[\u8FA3\u773C\u775B]":"https://upload.haoxx.site/emoji/ownEmoji/lyj.png","[\u5403\u74DC]":"https://upload.haoxx.site/emoji/ownEmoji/chigua.png","[\u6ED1\u7A3D]":"https://upload.haoxx.site/emoji/ownEmoji/guaji.png","[\u5472\u7259]":"https://upload.haoxx.site/emoji/ownEmoji/ciya.png","[\u6253call]":"https://upload.haoxx.site/emoji/ownEmoji/dacall.png","[\u50B2\u5A07]":"https://upload.haoxx.site/emoji/ownEmoji/aojiao.png","[\u561F\u561F]":"https://upload.haoxx.site/emoji/ownEmoji/dudu.png","[\u7FFB\u767D\u773C]":"https://upload.haoxx.site/emoji/ownEmoji/fanby.png","[\u5C34\u5C2C]":"https://upload.haoxx.site/emoji/ownEmoji/ganga.png","[\u7ED9\u5FC3\u5FC3]":"https://upload.haoxx.site/emoji/ownEmoji/geixx.png","[\u55D1\u74DC\u5B50]":"https://upload.haoxx.site/emoji/ownEmoji/kgz.png","[\u7B11\u54ED]":"https://upload.haoxx.site/emoji/ownEmoji/xiaoku.png","[\u5927\u7B11]":"https://upload.haoxx.site/emoji/ownEmoji/daxiao.png","[\u559C\u6B22]":"https://upload.haoxx.site/emoji/ownEmoji/xihuan.png","[\u7591\u60D1]":"https://upload.haoxx.site/emoji/ownEmoji/yihuo.png","[\u751F\u6C14]":"https://upload.haoxx.site/emoji/ownEmoji/shengqi.png","[\u9634\u9669]":"https://upload.haoxx.site/emoji/ownEmoji/yinxian.png","[doge]":"https://upload.haoxx.site/emoji/ownEmoji/doge.png","[\u70B9\u8D5E]":"https://upload.haoxx.site/emoji/ownEmoji/dianzan.png","[\u96BE\u8FC7]":"https://upload.haoxx.site/emoji/ownEmoji/nanguo.png","[\u5618\u58F0]":"https://upload.haoxx.site/emoji/ownEmoji/xusheng.png","[\u60CA\u8BB6]":"https://upload.haoxx.site/emoji/ownEmoji/jingya.png","[\u559C\u6781\u800C\u6CE3]":"https://upload.haoxx.site/emoji/ownEmoji/xjeq.png","[\u601D\u8003]":"https://upload.haoxx.site/emoji/ownEmoji/sikao.png","[\u9F13\u638C]":"https://upload.haoxx.site/emoji/ownEmoji/guzhang.png","[\u9178\u4E86]":"https://upload.haoxx.site/emoji/ownEmoji/suanle.png","[\u59D4\u5C48]":"https://upload.haoxx.site/emoji/ownEmoji/weiqu.png","[\u6342\u8138]":"https://upload.haoxx.site/emoji/ownEmoji/wulian.png","[\u6342\u773C]":"https://upload.haoxx.site/emoji/ownEmoji/wuyan.png","[\u54E6\u547C]":"https://upload.haoxx.site/emoji/ownEmoji/ohu.png","[\u65E0\u8BED]":"https://upload.haoxx.site/emoji/ownEmoji/wuyu.png","[\u5413]":"https://upload.haoxx.site/emoji/ownEmoji/xia.png","[\u75BC]":"https://upload.haoxx.site/emoji/ownEmoji/teng.png","[\u6B6A\u5634]":"https://upload.haoxx.site/emoji/ownEmoji/waizui.png","[\u6293\u72C2]":"https://upload.haoxx.site/emoji/ownEmoji/zhuakuang.png","[\u751F\u75C5]":"https://upload.haoxx.site/emoji/ownEmoji/shengbing.png","[\u8C03\u76AE]":"https://upload.haoxx.site/emoji/ownEmoji/tiaopi.png","[\u5999\u554A]":"https://upload.haoxx.site/emoji/ownEmoji/miaoa.png","[\u6487\u5634]":"https://upload.haoxx.site/emoji/ownEmoji/piezui.png","[\u518D\u89C1]":"https://upload.haoxx.site/emoji/ownEmoji/zaijian.png","[\u5ACC\u5F03]":"https://upload.haoxx.site/emoji/ownEmoji/xianqi.png","[\u594B\u6597]":"https://upload.haoxx.site/emoji/ownEmoji/fendou.png","[\u58A8\u955C]":"https://upload.haoxx.site/emoji/ownEmoji/mojing.png","[OK]":"https://upload.haoxx.site/emoji/ownEmoji/ok.png","[\u5E72\u676F]":"https://upload.haoxx.site/emoji/ownEmoji/ganbei.png","[\u7231\u5FC3]":"https://upload.haoxx.site/emoji/ownEmoji/aixin.png","[\u652F\u6301]":"https://upload.haoxx.site/emoji/ownEmoji/zhichi.png","[\u62B1\u62F3]":"https://upload.haoxx.site/emoji/ownEmoji/baoquan.png","[\u4FDD\u4F51]":"https://upload.haoxx.site/emoji/ownEmoji/baoyou.png","[\u80DC\u5229]":"https://upload.haoxx.site/emoji/ownEmoji/shengli.png","[\u52A0\u6CB9]":"https://upload.haoxx.site/emoji/ownEmoji/jiayou.png","[\u62E5\u62B1]":"https://upload.haoxx.site/emoji/ownEmoji/yongbao.png","[\u539F\u795E_\u6B38\u563F]":"https://upload.haoxx.site/emoji/ownEmoji/aihei.png","[\u539F\u795E_\u54C7]":"https://upload.haoxx.site/emoji/ownEmoji/wa.png","[\u539F\u795E_\u55EF]":"https://upload.haoxx.site/emoji/ownEmoji/en.png","[\u539F\u795E_\u54FC]":"https://upload.haoxx.site/emoji/ownEmoji/heng.png","[\u539F\u795E_\u559D\u8336]":"https://upload.haoxx.site/emoji/ownEmoji/hecha.png","[\u539F\u795E_\u751F\u6C14]":"https://upload.haoxx.site/emoji/ownEmoji/kqsq.png","[tv_\u5FAE\u7B11]":"https://upload.haoxx.site/emoji/ownEmoji/tvwx.png","[tv_\u659C\u773C\u7B11]":"https://upload.haoxx.site/emoji/ownEmoji/tvxyx.png"},fe={class:"emoji-content"},ke=["onClick"],Be=["src","title"],Fe=V({__name:"index",emits:["addEmoji"],setup(g,{emit:b}){const f=u=>{b("addEmoji",u)};return(u,s)=>{const x=Q,_=ae;return n(),G(_,{trigger:"click",placement:"bottom-start",style:{"max-height":"200px"},"content-style":"padding: 0.5rem;",width:250,scrollable:""},{trigger:K(()=>[e("span",null,[B(x,{"icon-class":"emoji",size:"1.2rem"})])]),default:K(()=>[e("div",fe,[(n(!0),i(L,null,S(t(oe),(a,E,y)=>(n(),i("span",{class:"emoji-item",key:y,onClick:j=>f(E)},[e("img",{src:a,title:E,class:"emoji",width:"24",height:"24"},null,8,Be)],8,ke))),128))])]),_:1})}}});const be=W(Fe,[["__scopeId","data-v-9c62aa3f"]]),De={key:0,class:"reply-box"},Ae={class:"box-normal"},$e={class:"reply-box-avatar"},Ie=["src"],Le=["src"],Re={class:"reply-box-warp"},Pe=["onInput","placeholder"],Te={class:"box-expand"},ze=V({__name:"ReplyBox",props:{commentType:{type:Number},show:{type:Boolean,default:!0},typeId:{type:Number}},emits:["reload"],setup(g,{expose:b,emit:f}){const u=g,{user:s,blog:x,app:_}=Y(),a={lineHeight:"normal",borderColor:"#ed6ea0",backgroundColor:"var(--grey-0)"},E=Z({nickname:"",sendActive:!1,show:u.show,commentContent:"",commentForm:{typeId:u.typeId,commentType:u.commentType,parentId:void 0,replyId:void 0,toUid:void 0,commentContent:""}}),{nickname:y,sendActive:j,show:k,commentContent:h,commentForm:d}=ee(E),r=z(()=>y.value?`\u56DE\u590D @${y.value}\uFF1A`:"\u53D1\u4E00\u6761\u53CB\u5584\u7684\u8BC4\u8BBA"),w=()=>{h.value.length==0?j.value=!1:j.value=!0},R=v=>{h.value+=v,j.value=!0},N=()=>{var v;if(!s.id){_.setLoginFlag(!0);return}if(h.value.trim()==""){(v=window.$message)==null||v.error("\u8BC4\u8BBA\u4E0D\u80FD\u4E3A\u7A7A");return}d.value.commentContent=h.value.replace(/\[.+?\]/g,F=>"<img src= '"+oe[F]+"' width='21' height='21' style='margin: 0 1px;vertical-align: text-bottom'/>"),xe(d.value).then(({data:F})=>{var A,o;F.flag&&(j.value=!1,h.value="",x.blogInfo.siteConfig.commentCheck?(A=window.$message)==null||A.warning("\u8BC4\u8BBA\u6210\u529F\uFF0C\u6B63\u5728\u5BA1\u6838\u4E2D"):(o=window.$message)==null||o.success("\u8BC4\u8BBA\u6210\u529F"),f("reload"))})};return b({commentForm:d,nickname:y,setReply:v=>{k.value=v}}),(v,F)=>{const A=be;return t(k)?(n(),i("div",De,[e("div",Ae,[e("div",$e,[t(s).avatar?(n(),i("img",{key:0,class:"shoka-avatar",src:t(s).avatar,alt:""},null,8,Ie)):(n(),i("img",{key:1,class:"shoka-avatar",src:t(x).blogInfo.siteConfig.touristAvatar,alt:""},null,8,Le))]),e("div",Re,[T(e("textarea",{class:"reply-box-textarea","onUpdate:modelValue":F[0]||(F[0]=o=>ue(h)?h.value=o:null),style:le(t(j)?a:""),onInput:pe(w,["prevent"]),placeholder:t(r)},null,44,Pe),[[ie,t(h)]])]),e("div",{class:U(["reply-box-send",t(j)?"send-active":""]),onClick:N}," \u8BC4\u8BBA ",2)]),e("div",Te,[B(A,{onAddEmoji:R})])])):D("",!0)}}}),Ne=g=>(he("data-v-d5f1793f"),g=g(),ge(),g),qe={class:"reply-warp",id:"reply-wrap"},Me={class:"reply-title"},Se={key:0},Ue={class:"reply-box-avatar"},Ve=["src"],Oe={class:"content-warp"},He={class:"user-info"},Ge={class:"user-name"},Ke=["innerHTML"],We={class:"reply-info"},Xe={class:"reply-time"},Je=["onClick"],Qe=["onClick"],Ye={class:"sub-user-info"},Ze=["src"],eo={class:"sub-user-name"},oo={class:"reply-content"},to={style:{color:"#008ac5"}},no=["innerHTML"],so={class:"reply-info"},ao={class:"reply-time"},io=["onClick"],uo=["onClick"],lo=["onClick"],po=Ne(()=>e("div",{class:"bottom-line"},null,-1)),mo={key:0,class:"loading-warp"},co={key:1,style:{padding:"1.25rem","text-align":"center"}},ro=V({__name:"CommentList",props:{commentType:{type:Number}},emits:["getCommentCount"],setup(g,{emit:b}){const f=g,{user:u,app:s}=Y(),x=I([]),_=I([]),a=I([]),E=z(()=>Number(J().params.id)?Number(J().params.id):void 0),y=z(()=>o=>u.commentLikeSet.indexOf(o)!=-1?"like-flag":""),j=Z({count:0,reFresh:!0,queryParams:{current:1,typeId:E.value,commentType:f.commentType},commentList:[]}),{count:k,reFresh:h,queryParams:d,commentList:r}=ee(j),w=o=>{if(!u.id){s.setLoginFlag(!0);return}let c=o.id;je(c).then(({data:p})=>{p.flag&&(u.commentLikeSet.indexOf(c)!=-1?o.likeCount-=1:o.likeCount+=1,u.commentLike(c))})};me(r,()=>{h.value=!1,re(()=>{h.value=!0})},{deep:!1});const R=(o,c)=>{H(c.id,{current:1,size:5}).then(({data:p})=>{c.replyVOList=p.data,c.replyCount>5&&_.value[o].setPaging(!0),a.value[o].style.display="none"})},N=(o,c,p)=>{H(p,{current:o,size:5}).then(({data:$})=>{r.value[c].replyVOList=$.data})},O=(o,c)=>{x.value.forEach($=>{$.setReply(!1)});const p=x.value[o];p.nickname=c.fromNickname,p.commentForm.replyId=c.id,p.commentForm.toUid=c.fromUid,p.commentForm.parentId=r.value[o].id,p.setReply(!0)},v=()=>{_e(d.value).then(({data:o})=>{d.value.current==1?r.value=o.data.recordList:r.value.push(...o.data.recordList),d.value.current++,k.value=o.data.count,b("getCommentCount",k.value)})},F=()=>{d.value.current=1,v()},A=o=>{H(r.value[o].id,{current:_.value[o].current,size:5}).then(({data:c})=>{r.value[o].replyVOList=c.data,r.value[o].replyCount++,x.value[o].setReply(!1),r.value[o].replyCount>5&&_.value[o].setPaging(!0),a.value[o].style.display="none"})};return ce(()=>{v()}),(o,c)=>{const p=Q,$=ze,te=Ce,ne=de;return n(),i("div",qe,[e("div",Me,[B(p,{"icon-class":"comment",size:"1.4rem",style:{"margin-right":"5px"}}),q(" \u8BC4\u8BBA ")]),B($,{onReload:F,"comment-type":g.commentType,"type-id":t(E)},null,8,["comment-type","type-id"]),t(k)>0&&t(h)?(n(),i("div",Se,[(n(!0),i(L,null,S(t(r),(m,P)=>(n(),i("div",{class:"reply-item",key:m.id},[e("div",Ue,[e("img",{class:"shoka-avatar",src:m.avatar},null,8,Ve)]),e("div",Oe,[e("div",He,[e("div",Ge,C(m.fromNickname),1),m.fromUid==1?(n(),G(p,{key:0,"icon-class":"badge"})):D("",!0)]),e("div",{class:"reply-content",innerHTML:m.commentContent},null,8,Ke),e("div",We,[e("span",Xe,C(t(X)(m.createTime)),1),e("span",{class:"reply-like",onClick:l=>w(m)},[B(p,{class:U(["like",t(y)(m.id)]),"icon-class":"like",size:"0.8rem",style:{"margin-right":"5px"}},null,8,["class"]),T(e("span",null,C(m.likeCount),513),[[M,m.likeCount]])],8,Je),e("span",{class:"reply-btn",onClick:l=>O(P,m)},"\u56DE\u590D",8,Qe)]),(n(!0),i(L,null,S(m.replyVOList,l=>(n(),i("div",{class:"sub-reply-item",key:l.id},[e("div",Ye,[e("img",{class:"sub-reply-avatar",src:l.avatar},null,8,Ze),e("div",eo,C(l.fromNickname),1),l.fromUid==1?(n(),G(p,{key:0,"icon-class":"badge",style:{"margin-left":"5px"}})):D("",!0)]),e("span",oo,[l.fromUid!==l.toUid?(n(),i(L,{key:0},[q("\u56DE\u590D "),e("span",to,"@"+C(l.toNickname),1),q(" :")],64)):D("",!0),e("span",{innerHTML:l.commentContent},null,8,no)]),e("div",so,[e("span",ao,C(t(X)(l.createTime)),1),e("span",{class:"reply-like",onClick:se=>w(l)},[B(p,{class:U(["like",t(y)(l.id)]),"icon-class":"like",size:"0.8rem",style:{"margin-right":"5px"}},null,8,["class"]),T(e("span",null,C(l.likeCount),513),[[M,l.likeCount>0]])],8,io),e("span",{class:"reply-btn",onClick:se=>O(P,l)},"\u56DE\u590D",8,uo)])]))),128)),T(e("div",{ref_for:!0,ref_key:"readMoreRef",ref:a,class:"view-more"},[e("span",null,"\u5171"+C(m.replyCount)+"\u6761\u56DE\u590D, ",1),e("span",{class:"view-more-btn",onClick:l=>R(P,m)},"\u70B9\u51FB\u67E5\u770B",8,lo)],512),[[M,m.replyCount>3]]),B(te,{ref_for:!0,ref_key:"pageRef",ref:_,total:m.replyCount,index:P,commentId:m.id,onGetCurrentPage:N},null,8,["total","index","commentId"]),B($,{ref_for:!0,ref_key:"replyRef",ref:x,class:"mt-4",show:!1,"comment-type":g.commentType,"type-id":t(E),onReload:l=>A(P)},null,8,["comment-type","type-id","onReload"]),po])]))),128)),t(k)>t(r).length?(n(),i("div",mo,[B(ne,{class:"btn",color:"#e9546b",onClick:v},{default:K(()=>[q(" \u52A0\u8F7D\u66F4\u591A... ")]),_:1})])):D("",!0)])):(n(),i("div",co,"\u6765\u53D1\u8BC4\u8BBA\u5427~"))])}}});const xo=W(ro,[["__scopeId","data-v-d5f1793f"]]);export{xo as _};
