import{d as V,r as I,L as z,x as T,W as M,h as s,o,c as i,b as t,t as f,z as D,F as L,g as S,N as U,i as W,A as G,y as K,e as x,_ as Q,$ as at,u as Y,n as Z,p as tt,U as it,O as ut,D as pt,a0 as ct,w as lt,j as dt,f as q,a1 as rt,a2 as X,X as J,I as mt,B as gt,C as _t}from"./index.93c6421d.js";import{a as ht,b as kt,l as vt,c as H}from"./index.e98729d2.js";const yt={class:"view-more-pagination"},wt={class:"pagination-page-count"},Ct=["onClick"],jt=V({__name:"Paging",props:{total:{type:Number,default:0},index:{type:Number},commentId:{type:Number}},emits:["getCurrentPage"],setup(_,{expose:b,emit:B}){const u=_,n=I(1),h=I(5),k=I(!1),a=z(()=>Math.ceil(u.total/h.value)),w=z(()=>a.value<=5?a.value:n.value<=4?[1,2,3,4,5,"...",a.value]:n.value>=a.value-4?[1,"...",a.value-5,a.value-4,a.value-3,a.value-2,a.value-1,a.value]:[1,"...",n.value-2,n.value-1,n.value,n.value+1,n.value+2,"...",a.value]),C=()=>{n.value-=1,B("getCurrentPage",n.value,u.index,u.commentId)},v=r=>{n.value=r,B("getCurrentPage",r,u.index,u.commentId)},F=()=>{n.value+=1,B("getCurrentPage",n.value,u.index,u.commentId)};return b({current:n,setPaging:r=>{k.value=r}}),(r,m)=>T((o(),i("div",yt,[t("span",wt,"\u5171"+f(s(a))+"\u9875",1),s(n)!==1?(o(),i("span",{key:0,class:"pagination-btn",onClick:C},"\u4E0A\u4E00\u9875")):D("",!0),(o(!0),i(L,null,S(s(w),(j,R)=>(o(),i(L,null,[typeof j=="number"?(o(),i("span",{key:R,onClick:N=>v(j),class:U(["pagination-page-number",s(n)==j?"current-page":""])},f(j),11,Ct)):(o(),i("span",{class:"pagination-page-do",key:j},"..."))],64))),256)),s(n)!==s(a)?(o(),i("span",{key:1,class:"pagination-btn",onClick:F},"\u4E0B\u4E00\u9875")):D("",!0)],512)),[[M,s(k)]])}});const ft=W(jt,[["__scopeId","data-v-13277137"]]),et={"[\u70ED]":"https://static.ttkwsd.top/emoji/re.png","[\u51B7]":"https://static.ttkwsd.top/emoji/leng.png","[\u8131\u5355doge]":"https://static.ttkwsd.top/emoji/doge.png","[\u5FAE\u7B11]":"https://static.ttkwsd.top/emoji/simle.png","[\u7B11]":"https://static.ttkwsd.top/emoji/xiao.png","[\u5446]":"https://static.ttkwsd.top/emoji/dai.png","[\u7075\u9B42\u51FA\u7A8D]":"https://static.ttkwsd.top/emoji/lhcq.png","[\u661F\u661F\u773C]":"https://static.ttkwsd.top/emoji/xxy.png","[\u8138\u7EA2]":"https://static.ttkwsd.top/emoji/lianhong.png","[\u5077\u7B11]":"https://static.ttkwsd.top/emoji/touxiao.png","[\u5410]":"https://static.ttkwsd.top/emoji/tu.png","[\u60CA\u559C]":"https://static.ttkwsd.top/emoji/jingxi.png","[\u56E7]":"https://static.ttkwsd.top/emoji/jiong.png","[\u62A0\u9F3B]":"https://static.ttkwsd.top/emoji/koubi.png","[\u54C8\u6B20]":"https://static.ttkwsd.top/emoji/hqian.png","[\u5927\u54ED]":"https://static.ttkwsd.top/emoji/daku.png","[\u8FA3\u773C\u775B]":"https://static.ttkwsd.top/emoji/lyj.png","[\u5403\u74DC]":"https://static.ttkwsd.top/emoji/chigua.png","[\u6ED1\u7A3D]":"https://static.ttkwsd.top/emoji/guaji.png","[\u5472\u7259]":"https://static.ttkwsd.top/emoji/ciya.png","[\u6253call]":"https://static.ttkwsd.top/emoji/dacall.png","[\u50B2\u5A07]":"https://static.ttkwsd.top/emoji/aojiao.png","[\u561F\u561F]":"https://static.ttkwsd.top/emoji/dudu.png","[\u7FFB\u767D\u773C]":"https://static.ttkwsd.top/emoji/fanby.png","[\u5C34\u5C2C]":"https://static.ttkwsd.top/emoji/ganga.png","[\u7ED9\u5FC3\u5FC3]":"https://static.ttkwsd.top/emoji/geixx.png","[\u55D1\u74DC\u5B50]":"https://static.ttkwsd.top/emoji/kgz.png","[\u7B11\u54ED]":"https://static.ttkwsd.top/emoji/xiaoku.png","[\u5927\u7B11]":"https://static.ttkwsd.top/emoji/daxiao.png","[\u559C\u6B22]":"https://static.ttkwsd.top/emoji/xihuan.png","[\u7591\u60D1]":"https://static.ttkwsd.top/emoji/yihuo.png","[\u751F\u6C14]":"https://static.ttkwsd.top/emoji/shengqi.png","[\u9634\u9669]":"https://static.ttkwsd.top/emoji/yinxian.png","[doge]":"https://static.ttkwsd.top/emoji/doge.png","[\u70B9\u8D5E]":"https://static.ttkwsd.top/emoji/dianzan.png","[\u96BE\u8FC7]":"https://static.ttkwsd.top/emoji/nanguo.png","[\u5618\u58F0]":"https://static.ttkwsd.top/emoji/xusheng.png","[\u60CA\u8BB6]":"https://static.ttkwsd.top/emoji/jingya.png","[\u559C\u6781\u800C\u6CE3]":"https://static.ttkwsd.top/emoji/xjeq.png","[\u601D\u8003]":"https://static.ttkwsd.top/emoji/sikao.png","[\u9F13\u638C]":"https://static.ttkwsd.top/emoji/guzhang.png","[\u9178\u4E86]":"https://static.ttkwsd.top/emoji/suanle.png","[\u59D4\u5C48]":"https://static.ttkwsd.top/emoji/weiqu.png","[\u6342\u8138]":"https://static.ttkwsd.top/emoji/wulian.png","[\u6342\u773C]":"https://static.ttkwsd.top/emoji/wuyan.png","[\u54E6\u547C]":"https://static.ttkwsd.top/emoji/ohu.png","[\u65E0\u8BED]":"https://static.ttkwsd.top/emoji/wuyu.png","[\u5413]":"https://static.ttkwsd.top/emoji/xia.png","[\u75BC]":"https://static.ttkwsd.top/emoji/teng.png","[\u6B6A\u5634]":"https://static.ttkwsd.top/emoji/waizui.png","[\u6293\u72C2]":"https://static.ttkwsd.top/emoji/zhuakuang.png","[\u751F\u75C5]":"https://static.ttkwsd.top/emoji/shengbing.png","[\u8C03\u76AE]":"https://static.ttkwsd.top/emoji/tiaopi.png","[\u5999\u554A]":"https://static.ttkwsd.top/emoji/miaoa.png","[\u6487\u5634]":"https://static.ttkwsd.top/emoji/piezui.png","[\u518D\u89C1]":"https://static.ttkwsd.top/emoji/zaijian.png","[\u5ACC\u5F03]":"https://static.ttkwsd.top/emoji/xianqi.png","[\u594B\u6597]":"https://static.ttkwsd.top/emoji/fendou.png","[\u58A8\u955C]":"https://static.ttkwsd.top/emoji/mojing.png","[OK]":"https://static.ttkwsd.top/emoji/ok.png","[\u5E72\u676F]":"https://static.ttkwsd.top/emoji/ganbei.png","[\u7231\u5FC3]":"https://static.ttkwsd.top/emoji/aixin.png","[\u652F\u6301]":"https://static.ttkwsd.top/emoji/zhichi.png","[\u62B1\u62F3]":"https://static.ttkwsd.top/emoji/baoquan.png","[\u4FDD\u4F51]":"https://static.ttkwsd.top/emoji/baoyou.png","[\u80DC\u5229]":"https://static.ttkwsd.top/emoji/shengli.png","[\u52A0\u6CB9]":"https://static.ttkwsd.top/emoji/jiayou.png","[\u62E5\u62B1]":"https://static.ttkwsd.top/emoji/yongbao.png","[\u539F\u795E_\u6B38\u563F]":"https://static.ttkwsd.top/emoji/aihei.png","[\u539F\u795E_\u54C7]":"https://static.ttkwsd.top/emoji/wa.png","[\u539F\u795E_\u55EF]":"https://static.ttkwsd.top/emoji/en.png","[\u539F\u795E_\u54FC]":"https://static.ttkwsd.top/emoji/heng.png","[\u539F\u795E_\u559D\u8336]":"https://static.ttkwsd.top/emoji/hecha.png","[\u539F\u795E_\u751F\u6C14]":"https://static.ttkwsd.top/emoji/kqsq.png","[tv_\u5FAE\u7B11]":"https://static.ttkwsd.top/emoji/tvwx.png","[tv_\u659C\u773C\u7B11]":"https://static.ttkwsd.top/emoji/tvxyx.png"},Bt={class:"emoji-content"},Ft=["onClick"],xt=["src","title"],Et=V({__name:"index",emits:["addEmoji"],setup(_,{emit:b}){const B=u=>{b("addEmoji",u)};return(u,n)=>{const h=Q,k=at;return o(),G(k,{trigger:"click",placement:"bottom-start",style:{"max-height":"200px"},"content-style":"padding: 0.5rem;",width:250,scrollable:""},{trigger:K(()=>[t("span",null,[x(h,{"icon-class":"emoji",size:"1.2rem"})])]),default:K(()=>[t("div",Bt,[(o(!0),i(L,null,S(s(et),(a,w,C)=>(o(),i("span",{class:"emoji-item",key:C,onClick:v=>B(w)},[t("img",{src:a,title:w,class:"emoji",width:"24",height:"24"},null,8,xt)],8,Ft))),128))])]),_:1})}}});const bt=W(Et,[["__scopeId","data-v-9c62aa3f"]]),Dt={key:0,class:"reply-box"},At={class:"box-normal"},$t={class:"reply-box-avatar"},It=["src"],Lt=["src"],Rt={class:"reply-box-warp"},Pt=["onInput","placeholder"],Tt={class:"box-expand"},zt=V({__name:"ReplyBox",props:{commentType:{type:Number},show:{type:Boolean,default:!0},typeId:{type:Number}},emits:["reload"],setup(_,{expose:b,emit:B}){const u=_,{user:n,blog:h,app:k}=Y(),a={lineHeight:"normal",borderColor:"#ed6ea0",backgroundColor:"var(--grey-0)"},w=Z({nickname:"",sendActive:!1,show:u.show,commentContent:"",commentForm:{typeId:u.typeId,commentType:u.commentType,parentId:void 0,replyId:void 0,toUid:void 0,commentContent:""}}),{nickname:C,sendActive:v,show:F,commentContent:g,commentForm:r}=tt(w),m=z(()=>C.value?`\u56DE\u590D @${C.value}\uFF1A`:"\u53D1\u4E00\u6761\u53CB\u5584\u7684\u8BC4\u8BBA"),j=()=>{g.value.length==0?v.value=!1:v.value=!0},R=y=>{g.value+=y,v.value=!0},N=()=>{var y;if(!n.id){k.setLoginFlag(!0);return}if(g.value.trim()==""){(y=window.$message)==null||y.error("\u8BC4\u8BBA\u4E0D\u80FD\u4E3A\u7A7A");return}r.value.commentContent=g.value.replace(/\[.+?\]/g,E=>"<img src= '"+et[E]+"' width='21' height='21' style='margin: 0 1px;vertical-align: text-bottom'/>"),ht(r.value).then(({data:E})=>{var A,e;E.flag&&(v.value=!1,g.value="",h.blogInfo.siteConfig.commentCheck?(A=window.$message)==null||A.warning("\u8BC4\u8BBA\u6210\u529F\uFF0C\u6B63\u5728\u5BA1\u6838\u4E2D"):(e=window.$message)==null||e.success("\u8BC4\u8BBA\u6210\u529F"),B("reload"))})};return b({commentForm:r,nickname:C,setReply:y=>{F.value=y}}),(y,E)=>{const A=bt;return s(F)?(o(),i("div",Dt,[t("div",At,[t("div",$t,[s(n).avatar?(o(),i("img",{key:0,class:"shoka-avatar",src:s(n).avatar,alt:""},null,8,It)):(o(),i("img",{key:1,class:"shoka-avatar",src:s(h).blogInfo.siteConfig.touristAvatar,alt:""},null,8,Lt))]),t("div",Rt,[T(t("textarea",{class:"reply-box-textarea","onUpdate:modelValue":E[0]||(E[0]=e=>ut(g)?g.value=e:null),style:pt(s(v)?a:""),onInput:ct(j,["prevent"]),placeholder:s(m)},null,44,Pt),[[it,s(g)]])]),t("div",{class:U(["reply-box-send",s(v)?"send-active":""]),onClick:N}," \u8BC4\u8BBA ",2)]),t("div",Tt,[x(A,{onAddEmoji:R})])])):D("",!0)}}}),Nt=_=>(gt("data-v-d5f1793f"),_=_(),_t(),_),qt={class:"reply-warp",id:"reply-wrap"},Mt={class:"reply-title"},St={key:0},Ut={class:"reply-box-avatar"},Vt=["src"],Ot={class:"content-warp"},Ht={class:"user-info"},Gt={class:"user-name"},Kt=["innerHTML"],Wt={class:"reply-info"},Xt={class:"reply-time"},Jt=["onClick"],Qt=["onClick"],Yt={class:"sub-user-info"},Zt=["src"],te={class:"sub-user-name"},ee={class:"reply-content"},se={style:{color:"#008ac5"}},oe=["innerHTML"],ne={class:"reply-info"},ae={class:"reply-time"},ie=["onClick"],ue=["onClick"],pe=["onClick"],ce=Nt(()=>t("div",{class:"bottom-line"},null,-1)),le={key:0,class:"loading-warp"},de={key:1,style:{padding:"1.25rem","text-align":"center"}},re=V({__name:"CommentList",props:{commentType:{type:Number}},emits:["getCommentCount"],setup(_,{emit:b}){const B=_,{user:u,app:n}=Y(),h=I([]),k=I([]),a=I([]),w=z(()=>Number(J().params.id)?Number(J().params.id):void 0),C=z(()=>e=>u.commentLikeSet.indexOf(e)!=-1?"like-flag":""),v=Z({count:0,reFresh:!0,queryParams:{current:1,typeId:w.value,commentType:B.commentType},commentList:[]}),{count:F,reFresh:g,queryParams:r,commentList:m}=tt(v),j=e=>{if(!u.id){n.setLoginFlag(!0);return}let d=e.id;vt(d).then(({data:c})=>{c.flag&&(u.commentLikeSet.indexOf(d)!=-1?e.likeCount-=1:e.likeCount+=1,u.commentLike(d))})};lt(m,()=>{g.value=!1,mt(()=>{g.value=!0})},{deep:!1});const R=(e,d)=>{H(d.id,{current:1,size:5}).then(({data:c})=>{d.replyVOList=c.data,d.replyCount>5&&k.value[e].setPaging(!0),a.value[e].style.display="none"})},N=(e,d,c)=>{H(c,{current:e,size:5}).then(({data:$})=>{m.value[d].replyVOList=$.data})},O=(e,d)=>{h.value.forEach($=>{$.setReply(!1)});const c=h.value[e];c.nickname=d.fromNickname,c.commentForm.replyId=d.id,c.commentForm.toUid=d.fromUid,c.commentForm.parentId=m.value[e].id,c.setReply(!0)},y=()=>{kt(r.value).then(({data:e})=>{r.value.current==1?m.value=e.data.recordList:m.value.push(...e.data.recordList),r.value.current++,F.value=e.data.count,b("getCommentCount",F.value)})},E=()=>{r.value.current=1,y()},A=e=>{H(m.value[e].id,{current:k.value[e].current,size:5}).then(({data:d})=>{m.value[e].replyVOList=d.data,m.value[e].replyCount++,h.value[e].setReply(!1),m.value[e].replyCount>5&&k.value[e].setPaging(!0),a.value[e].style.display="none"})};return dt(()=>{y()}),(e,d)=>{const c=Q,$=zt,st=ft,ot=rt;return o(),i("div",qt,[t("div",Mt,[x(c,{"icon-class":"comment",size:"1.4rem",style:{"margin-right":"5px"}}),q(" \u8BC4\u8BBA ")]),x($,{onReload:E,"comment-type":_.commentType,"type-id":s(w)},null,8,["comment-type","type-id"]),s(F)>0&&s(g)?(o(),i("div",St,[(o(!0),i(L,null,S(s(m),(l,P)=>(o(),i("div",{class:"reply-item",key:l.id},[t("div",Ut,[t("img",{class:"shoka-avatar",src:l.avatar},null,8,Vt)]),t("div",Ot,[t("div",Ht,[t("div",Gt,f(l.fromNickname),1),l.fromUid==1?(o(),G(c,{key:0,"icon-class":"badge"})):D("",!0)]),t("div",{class:"reply-content",innerHTML:l.commentContent},null,8,Kt),t("div",Wt,[t("span",Xt,f(s(X)(l.createTime)),1),t("span",{class:"reply-like",onClick:p=>j(l)},[x(c,{class:U(["like",s(C)(l.id)]),"icon-class":"like",size:"0.8rem",style:{"margin-right":"5px"}},null,8,["class"]),T(t("span",null,f(l.likeCount),513),[[M,l.likeCount]])],8,Jt),t("span",{class:"reply-btn",onClick:p=>O(P,l)},"\u56DE\u590D",8,Qt)]),(o(!0),i(L,null,S(l.replyVOList,p=>(o(),i("div",{class:"sub-reply-item",key:p.id},[t("div",Yt,[t("img",{class:"sub-reply-avatar",src:p.avatar},null,8,Zt),t("div",te,f(p.fromNickname),1),p.fromUid==1?(o(),G(c,{key:0,"icon-class":"badge",style:{"margin-left":"5px"}})):D("",!0)]),t("span",ee,[p.fromUid!==p.toUid?(o(),i(L,{key:0},[q("\u56DE\u590D "),t("span",se,"@"+f(p.toNickname),1),q(" :")],64)):D("",!0),t("span",{innerHTML:p.commentContent},null,8,oe)]),t("div",ne,[t("span",ae,f(s(X)(p.createTime)),1),t("span",{class:"reply-like",onClick:nt=>j(p)},[x(c,{class:U(["like",s(C)(p.id)]),"icon-class":"like",size:"0.8rem",style:{"margin-right":"5px"}},null,8,["class"]),T(t("span",null,f(p.likeCount),513),[[M,p.likeCount>0]])],8,ie),t("span",{class:"reply-btn",onClick:nt=>O(P,p)},"\u56DE\u590D",8,ue)])]))),128)),T(t("div",{ref_for:!0,ref_key:"readMoreRef",ref:a,class:"view-more"},[t("span",null,"\u5171"+f(l.replyCount)+"\u6761\u56DE\u590D, ",1),t("span",{class:"view-more-btn",onClick:p=>R(P,l)},"\u70B9\u51FB\u67E5\u770B",8,pe)],512),[[M,l.replyCount>3]]),x(st,{ref_for:!0,ref_key:"pageRef",ref:k,total:l.replyCount,index:P,commentId:l.id,onGetCurrentPage:N},null,8,["total","index","commentId"]),x($,{ref_for:!0,ref_key:"replyRef",ref:h,class:"mt-4",show:!1,"comment-type":_.commentType,"type-id":s(w),onReload:p=>A(P)},null,8,["comment-type","type-id","onReload"]),ce])]))),128)),s(F)>s(m).length?(o(),i("div",le,[x(ot,{class:"btn",color:"#e9546b",onClick:y},{default:K(()=>[q(" \u52A0\u8F7D\u66F4\u591A... ")]),_:1})])):D("",!0)])):(o(),i("div",de,"\u6765\u53D1\u8BC4\u8BBA\u5427~"))])}}});const _e=W(re,[["__scopeId","data-v-d5f1793f"]]);export{_e as _};
