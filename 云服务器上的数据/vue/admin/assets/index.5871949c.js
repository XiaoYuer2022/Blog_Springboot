import{a3 as w,d as ge,r as be,e as O,s as Fe,ae as Ce,af as Ee,a as ye,N as we,a5 as Ve,A as xe,y as B,o as z,c as Q,i as e,w as t,v as l,j as n,t as F,z as d,S as y,F as Ie,C as ke,J as De,Q as Y,R as Z,T as Ue,U as L,Y as Pe,G as Ae,H as Be,g as ze,aO as Le,Z as Ne,aw as Se,ax as Re,ay as qe,aT as Me,aV as Te,E as $e,f as Ge,h as je,an as He,ak as Je,p as Oe,n as Qe,q as Ye}from"./index.06298527.js";import{i as Ze}from"./index.3d3d4277.js";/* empty css               *//* empty css                        */function Ke(s){return w({url:"/admin/photo/list",method:"get",params:s})}function We(s){return w({url:`/admin/photo/album/${s}/info`,method:"get"})}function Xe(s){return w({url:"/admin/photo/add",method:"post",data:s})}function eo(s){return w({url:"/admin/photo/update",method:"put",data:s})}function oo(s){return w({url:"/admin/photo/delete",method:"delete",data:s})}const N=s=>(Oe("data-v-bfd1f088"),s=s(),Qe(),s),to={class:"app-container"},ao={class:"album-name"},lo={class:"photo-count"},uo={class:"photo-item"},no={class:"photo-operation"},so={class:"photo-name"},io={class:"dialog-footer"},ro={class:"upload-container"},po=N(()=>n("img",{class:"avatar"},null,-1)),co={class:"upload"},mo=N(()=>n("div",{class:"el-upload__text"},[d(" \u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),n("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),_o=N(()=>n("img",{width:"360"},null,-1)),fo={class:"dialog-footer"},ho=["src"],vo=ge({__name:"index",setup(s){const D=be(),K=O({photoName:[{required:!0,message:"\u8BF7\u8F93\u5165\u7167\u7247\u540D\u79F0",trigger:"blur"}]}),S=Fe(()=>({Authorization:Ce+Ee()})),U=ye(),W=O({count:0,loading:!1,upload:!1,update:!1,checkAll:!1,isIndeterminate:!1,dialogImageUrl:"",dialogVisible:!1,queryParams:{current:1,size:18,albumId:Number(U.params.albumId)},photoForm:{},photoIdList:[],selectPhotoIdList:[],photoList:[],albumInfo:{},uploadList:[]}),{count:R,loading:q,upload:h,update:v,checkAll:V,isIndeterminate:x,dialogImageUrl:M,dialogVisible:I,queryParams:c,photoForm:m,photoIdList:C,selectPhotoIdList:r,photoList:k,albumInfo:E,uploadList:i}=we(W);Ve(k,()=>{C.value=[],k.value.forEach(a=>{C.value.push(a.id)})});const X=a=>{c.value.size=a,g()},ee=a=>{c.value.current=a,g()},oe=a=>{r.value=a?C.value:[],x.value=!1},te=a=>{const o=a.length;V.value=o===C.value.length,x.value=o>0&&o<C.value.length},ae=a=>{var o;(o=D.value)==null||o.resetFields(),m.value=a,v.value=!0},T=a=>new Promise(o=>{a.size/1024<200&&o(a),Ze.exports.compressAccurately(a,200).then(p=>{o(p)})}),$=a=>{i.value.push({url:a.data})},le=a=>{i.value.forEach((o,p)=>{o.url==a.url&&i.value.splice(p,1)})},ue=a=>{M.value=a.url,I.value=!0},ne=()=>{Ue("\u786E\u8BA4\u5220\u9664\u5DF2\u9009\u4E2D\u7684\u6570\u636E\u9879?").then(()=>{oo(r.value).then(({data:a})=>{a.flag&&(L(a.msg),g(),r.value=[],x.value=!1)})}).catch(()=>{})},se=()=>{let a=[];i.value.length>0&&i.value.forEach(o=>{a.push(o.url)}),Xe({albumId:Number(U.params.albumId),photoUrlList:a}).then(({data:o})=>{o.flag&&(L(o.msg),i.value=[],g()),h.value=!1})},de=()=>{var a;(a=D.value)==null||a.validate(o=>{o&&eo(m.value).then(({data:p})=>{p.flag&&(L(p.msg),g()),v.value=!1})})},g=()=>{q.value=!0,Ke(c.value).then(({data:a})=>{k.value=a.data.recordList,R.value=a.data.count,q.value=!1})};return xe(()=>{g(),We(Number(U.params.albumId)).then(({data:a})=>{E.value=a.data})}),(a,o)=>{const p=Pe,_=Ae,b=Be,f=ze,G=Le,ie=B("MoreFilled"),P=Ne,re=Se,pe=Re,ce=qe,me=Me,_e=Te,j=$e,H=Ge,fe=je,A=He,he=B("Plus"),J=Je,ve=B("upload-filled");return z(),Q("div",to,[e(b,{gutter:12,class:"mb15"},{default:t(()=>[e(_,{span:1.5},{default:t(()=>[e(p,{fit:"cover",class:"album-cover",src:l(E).albumCover},null,8,["src"])]),_:1},8,["span"]),e(_,{span:12},{default:t(()=>[e(b,{align:"bottom"},{default:t(()=>[n("span",ao,F(l(E).albumName),1),n("span",lo,F(l(E).photoCount)+"\u5F20",1)]),_:1}),e(b,{class:"album-desc"},{default:t(()=>[d(F(l(E).albumDesc),1)]),_:1}),e(b,{class:"select-count"},{default:t(()=>[d("\u5DF2\u9009\u62E9"+F(l(r).length)+"\u5F20",1)]),_:1})]),_:1})]),_:1}),e(b,{gutter:10,class:"mb20"},{default:t(()=>[e(_,{span:1.5},{default:t(()=>[e(f,{type:"primary",plain:"",icon:"Upload",onClick:o[0]||(o[0]=u=>h.value=!0)},{default:t(()=>[d("\u4E0A\u4F20")]),_:1})]),_:1},8,["span"]),e(_,{span:1.5},{default:t(()=>[e(f,{type:"success",plain:"",icon:"Promotion",disabled:l(r).length==0},{default:t(()=>[d("\u79FB\u52A8")]),_:1},8,["disabled"])]),_:1},8,["span"]),e(_,{span:1.5},{default:t(()=>[e(f,{type:"danger",plain:"",icon:"Delete",disabled:l(r).length==0,onClick:ne},{default:t(()=>[d("\u6279\u91CF\u5220\u9664")]),_:1},8,["disabled"])]),_:1},8,["span"]),e(_,{span:1.5},{default:t(()=>[e(G,{modelValue:l(V),"onUpdate:modelValue":o[1]||(o[1]=u=>y(V)?V.value=u:null),indeterminate:l(x),onChange:oe},{default:t(()=>[d(" \u5168\u9009 ")]),_:1},8,["modelValue","indeterminate"])]),_:1},8,["span"])]),_:1}),e(me,{modelValue:l(r),"onUpdate:modelValue":o[2]||(o[2]=u=>y(r)?r.value=u:null),onChange:te},{default:t(()=>[e(b,{class:"picture-list",gutter:10},{default:t(()=>[(z(!0),Q(Ie,null,ke(l(k),u=>(z(),De(_,{xs:12,sm:6,lg:4,key:u.id,style:{"margin-bottom":"1rem"}},{default:t(()=>[e(G,{label:u.id},{default:t(()=>[n("div",uo,[n("div",no,[e(ce,{onCommand:ae},{dropdown:t(()=>[e(pe,null,{default:t(()=>[e(re,{command:u},{default:t(()=>[d("\u7F16\u8F91")]),_:2},1032,["command"])]),_:2},1024)]),default:t(()=>[e(P,{style:{color:"#fff"}},{default:t(()=>[e(ie)]),_:1})]),_:2},1024)]),e(p,{class:"photo-cover",fit:"cover",src:u.photoUrl,"preview-src-list":[u.photoUrl]},null,8,["src","preview-src-list"]),n("div",so,F(u.photoName),1)])]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"]),e(_e,{class:"pagination-container","current-page":l(c).current,"onUpdate:currentPage":o[3]||(o[3]=u=>l(c).current=u),"page-size":l(c).size,"onUpdate:pageSize":o[4]||(o[4]=u=>l(c).size=u),"hide-on-single-page":!0,layout:" prev, pager, next",total:l(R),onSizeChange:X,onCurrentChange:ee},null,8,["current-page","page-size","total"]),e(A,{title:"\u4FEE\u6539\u7167\u7247",modelValue:l(v),"onUpdate:modelValue":o[8]||(o[8]=u=>y(v)?v.value=u:null),width:"550px","append-to-body":""},{footer:t(()=>[n("div",io,[e(f,{type:"primary",onClick:de},{default:t(()=>[d("\u786E \u5B9A")]),_:1}),e(f,{onClick:o[7]||(o[7]=u=>v.value=!1)},{default:t(()=>[d("\u53D6 \u6D88")]),_:1})])]),default:t(()=>[e(fe,{ref_key:"photoFormRef",ref:D,"label-width":"100px",model:l(m),rules:K},{default:t(()=>[e(H,{label:"\u7167\u7247\u540D\u79F0",prop:"photoName"},{default:t(()=>[e(j,{placeholder:"\u8BF7\u8F93\u5165\u7167\u7247\u540D\u79F0",modelValue:l(m).photoName,"onUpdate:modelValue":o[5]||(o[5]=u=>l(m).photoName=u),style:{width:"250px"}},null,8,["modelValue"])]),_:1}),e(H,{label:"\u7167\u7247\u63CF\u8FF0",prop:"photoDesc"},{default:t(()=>[e(j,{placeholder:"\u8BF7\u8F93\u5165\u7167\u7247\u63CF\u8FF0",modelValue:l(m).photoDesc,"onUpdate:modelValue":o[6]||(o[6]=u=>l(m).photoDesc=u),style:{width:"250px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(A,{title:"\u4E0A\u4F20\u7167\u7247",modelValue:l(h),"onUpdate:modelValue":o[10]||(o[10]=u=>y(h)?h.value=u:null),width:"800px","append-to-body":""},{footer:t(()=>[n("div",fo,[n("div",null," \u5171\u4E0A\u4F20"+F(l(i).length)+"\u5F20\u7167\u7247 ",1),n("div",null,[e(f,{type:"primary",disabled:l(i).length==0,onClick:se},{default:t(()=>[d("\u786E \u5B9A")]),_:1},8,["disabled"]),e(f,{onClick:o[9]||(o[9]=u=>h.value=!1)},{default:t(()=>[d("\u53D6 \u6D88")]),_:1})])])]),default:t(()=>[n("div",ro,[Y(e(J,{headers:l(S),class:"avatar-uploader",multiple:"",action:"/api/admin/photo/upload","before-upload":T,"on-success":$,"on-remove":le,"on-preview":ue,"list-type":"picture-card","file-list":l(i),accept:"image/*"},{default:t(()=>[po,e(P,{class:"avatar-uploader-icon"},{default:t(()=>[e(he)]),_:1})]),_:1},8,["headers","file-list"]),[[Z,l(i).length>0]]),n("div",co,[Y(e(J,{headers:l(S),drag:"",multiple:"",action:"/api/admin/photo/upload","before-upload":T,"show-file-list":!1,accept:"image/*","on-success":$,style:{width:"360px"}},{default:t(()=>[e(P,{class:"el-icon--upload"},{default:t(()=>[e(ve)]),_:1}),mo,_o]),_:1},8,["headers"]),[[Z,l(i).length===0]])])])]),_:1},8,["modelValue"]),e(A,{modelValue:l(I),"onUpdate:modelValue":o[11]||(o[11]=u=>y(I)?I.value=u:null),"append-to-body":""},{default:t(()=>[n("img",{src:l(M),style:{"max-width":"100%"}},null,8,ho)]),_:1},8,["modelValue"])])}}});const Eo=Ye(vo,[["__scopeId","data-v-bfd1f088"]]);export{Eo as default};
